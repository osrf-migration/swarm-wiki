This tutorial describes how to upload a log file to Amazon's S3.

Each team should have received S3 credentials. If not, contact your team lead or Nate (nate@osrfoundation.org).

## Log files to upload

It is necessary to upload both the swarm and gazebo log files. These log files are located at:

```
~/.swarm/log/TIMESTAMP/swarm.log
~/.gazebo/log/TIMESTAMP/gzserver/state.log
```

A single run of simulation should have similar TIMESTAMPS for both log directories. Upload both log files into a directory on S3. If the timestamps differ, choose the swarm log file.

## Directory structure

All logs should be uploaded to `s3://osrf-swarm/<team>/<timestamp>`, where `<team>` is one of `[byu, gatech, nps, upenn]`, and <timestamp> is the time stamp generated by simulation (see above). The credentials provides upload access to only your team's directory.

## Install S3 command line tool

`sudo apt-get install s3cmd`

## Configure s3cmd

`s3cmd --configure`

Enter the Access Key and Secret Key. Leave other fields blank, do not test the setup, and then save the setup.

## List directory contents

```
s3cmd ls s3://osrf-swarm/<team>
```

## Upload a log file

```
s3cmd sync <your_file_or_directory> s3://osrf-swarm/<team>/<timestamp>/
```

The `s3cmd` is a bit picky about forward slashes:

* If you are uploading a directory, do not put a trailing forward-slash on the local directory name:

    * Good: `s3cmd sync my_dir_name s3://osrf-swarm/<team>/`
    * Bad:  `s3cmd sync my_dir_name/ s3://osrf-swarm/<team>/`

In general, you should upload both `~/.gazebo/log/<timestamp>/gzserver/state.log` and `~/.swarm/log/<timestamp>/swarm.log`.  See the [tutorial on logging](https://bitbucket.org/osrf/swarm/wiki/Tutorial_9-Logging) for more information.

## Uploading tip

1. Place all your log files, and any supplementary files into one timestamped directory. For example:

    ```
cd /tmp
    ```

    ```
cp ~/.swarm/log/2015-10-22T11:02:31.861422 .
    ```

    ```
cp ~/.gazebo/log/2015-10-22T11:02:31.861422/gzserver/* 2015-10-22T11:02:31.861422 
    ```

1. Upload that directory to s3

    ```
s3cmd sync 2015-10-22T11:02:31.861422 s3://osrf-swarm/<team>/
    ```

1. Note that there is no trailing slash on local directory name, but a trailing slash on the team.

1. Check for a correct upload by listing the directory contents on s3. There should be a timestamped directory, with a trailing forward-slash.

    ```
s3cmd ls s3://osrf-swarm/<team>
    ```

